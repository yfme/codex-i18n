<h1 align="center">OpenAI Codex CLI</h1>
<p align="center">Лёгкий агент программирования, работающий в вашем терминале</p>

<p align="center"><code>npm i -g @openai/codex</code></p>

[English](./README.md) | [简体中文](./README.zh-CN.md) | [Español](./README.es.md) | [Português](./README.pt.md) | **Русский** | [Français](./README.fr.md) | [Deutsch](./README.de.md) | [日本語](./README.ja.md) | [한국어](./README.ko.md) | [繁體中文](./README.zh-TW.md) | [Bahasa Indonesia](./README.id.md) | [Italiano](./README.it.md)

![Codex demo GIF используя: codex "explain this codebase to me"](./.github/demo.gif)

---

<details>
<summary><strong>Оглавление</strong></summary>

- [Отказ от ответственности по экспериментальной технологии](#отказ-от-ответственности-по-экспериментальной-технологии)
- [Быстрый старт](#быстрый-старт)
- [Почему Codex?](#почему-codex)
- [Модель безопасности и разрешения](#модель-безопасности-и-разрешения)
  - [Детали песочницы платформы](#детали-песочницы-платформы)
- [Системные требования](#системные-требования)
- [Справочник CLI](#справочник-cli)
- [Память и документация проекта](#память-и-документация-проекта)
- [Ноинтерактивный / CI режим](#ноинтерактивный--ci-режим)
- [Рецепты](#рецепты)
- [Установка](#установка)
- [Конфигурация](#конфигурация)
- [Часто задаваемые вопросы](#часто-задаваемые-вопросы)
- [Возможности финансирования](#возможности-финансирования)
- [Вклад в проект](#вклад-в-проект)
  - [Рабочий процесс разработки](#рабочий-процесс-разработки)
  - [Написание высокоударных изменений кода](#написание-высокоударных-изменений-кода)
  - [Открытие запроса на включение](#открытие-запроса-на-включение)
  - [Процесс проверки](#процесс-проверки)
  - [Ценности сообщества](#ценности-сообщества)
  - [Получение помощи](#получение-помощи)
  - [Соглашение о лицензии для участников (CLA)](#соглашение-о-лицензии-для-участников-cla)
    - [Быстрые исправления](#быстрые-исправления)
  - [Выпуск `codex`](#выпуск-codex)
- [Безопасность и ответственный ИИ](#безопасность-и-ответственный-ии)
- [Лицензия](#лицензия)

</details>

---

## Отказ от ответственности по экспериментальной технологии

Codex CLI — это экспериментальный проект, находящийся в активной разработке. Он ещё не стабилен, может содержать ошибки, незавершённые функции или подвергаться значительным изменениям. Мы разрабатываем его открыто вместе с сообществом и приветствуем:

- Сообщения об ошибках
- Запросы на новые функции
- Запросы на включение
- Позитивные отзывы

Помогите нам улучшить проект, сообщая об ошибках или отправляя запросы на включение (см. раздел ниже о том, как внести вклад)!

## Быстрый старт

Установите глобально:

```shell
npm install -g @openai/codex
```

Затем установите ваш ключ OpenAI API как переменную окружения:

```shell
export OPENAI_API_KEY="your-api-key-here"
```

> **Примечание:** Эта команда устанавливает ключ только для текущей сессии терминала. Чтобы сделать его постоянным, добавьте строку `export` в файл конфигурации вашего шелла (например, `~/.zshrc`).

Запустите в интерактивном режиме:

```shell
codex
```

Или запустите с подсказкой в качестве входных данных (и опционально в режиме `Full Auto`):

```shell
codex "объясни мне этот код"
```

```shell
codex --approval-mode full-auto "создай самое крутое приложение для списка дел"
```

Вот и всё — Codex создаст файл, выполнит его в песочнице, установит недостающие зависимости и покажет вам результат в реальном времени. Подтвердите изменения, и они будут зафиксированы в вашем рабочем каталоге.

---

## Почему Codex?

Codex CLI создан для разработчиков, которые уже **живут в терминале** и хотят получить возможности рассуждения уровня ChatGPT **плюс** возможность фактически запускать код, манипулировать файлами и итерировать — всё под контролем версий. Короче говоря, это _разработка, управляемая чатом_, которая понимает и выполняет ваш репозиторий.

- **Нулевая настройка** — принесите свой ключ OpenAI API, и всё работает!
- **Полное автоматическое подтверждение, при этом безопасно** за счёт отключения сети и песочницы каталогов
- **Мультимодальность** — передавайте снимки экрана или диаграммы для реализации функций ✨

И он **полностью с открытым исходным кодом**, так что вы можете видеть и вносить вклад в его развитие!

---

## Модель безопасности и разрешения

Codex позволяет вам решать, _какой уровень автономии_ получает агент, и политику автоматического подтверждения через флаг `--approval-mode` (или интерактивную подсказку при запуске):

| Режим                      | Что агент может делать без запроса            | Всё ещё требует подтверждения                                         |
| ------------------------- | ----------------------------------------------- | --------------------------------------------------------------- |
| **Предложение** <br>(по умолчанию) | • Читать любой файл в репозитории                     | • **Все** записи/патчи файлов <br>• **Все** команды shell/Bash |
| **Авторедактирование**             | • Читать **и** применять патчи к файлам      | • **Все** команды shell/Bash                                   |
| **Полная автоматизация**             | • Читать/записывать файлы <br>• Выполнять команды shell | —                                                               |

В режиме **Полная автоматизация** каждая команда выполняется с **отключённой сетью** и ограничена текущим рабочим каталогом (плюс временные файлы) для защиты в глубину. Codex также покажет предупреждение/подтверждение, если вы начнёте в режиме **авторедактирования** или **полной автоматизации**, а каталог _не_ отслеживается Git, так что у вас всегда есть страховка.

Скоро: вы сможете разрешить выполнение определённых команд с включённой сетью, как только мы будем уверены в дополнительных мерах безопасности.

### Детали песочницы платформы

Механизм усиления, используемый Codex, зависит от вашей ОС:

- **macOS 12+** — команды оборачиваются в **Apple Seatbelt** (`sandbox-exec`).

  - Всё помещается в изолированную среду только для чтения, за исключением небольшого набора корневых каталогов с правом записи (`$PWD`, `$TMPDIR`, `~/.codex` и т.д.).
  - Исходящая сеть _полностью заблокирована_ по умолчанию — даже если дочерний процесс попытается выполнить `curl`, он завершится с ошибкой.

- **Linux** — мы рекомендуем использовать Docker для песочницы, где Codex запускается в **минимальном образе контейнера** и монтирует ваш репозиторий с правами _чтения/записи_ по тому же пути. Специальный скрипт брандмауэра `iptables`/`ipset` блокирует весь исходящий трафик, кроме API OpenAI. Это обеспечивает детерминированные, воспроизводимые запуски без необходимости root-доступа на хосте. Подробнее в [`run_in_container.sh`](./codex-cli/scripts/run_in_container.sh).

Оба подхода _прозрачны_ для повседневного использования — вы всё ещё запускаете `codex` из корня репозитория и подтверждаете/отклоняете шаги как обычно.

---

## Системные требования

| Требование                 | Детали                                                         |
| --------------------------- | --------------------------------------------------------------- |
| Операционные системы           | macOS 12+, Ubuntu 20.04+/Debian 10+, или Windows 11 **через WSL2** |
| Node.js                     | **22 или новее** (рекомендуется LTS)                               |
| Git (опционально, рекомендуется) | 2.23+ для встроенных помощников PR                                   |
| Оперативная память                         | Минимум 4 ГБ (рекомендуется 8 ГБ)                                 |

> Никогда не выполняйте `sudo npm install -g`; вместо этого исправьте права npm.

---

## Справочник CLI

| Команда                              | Назначение                             | Пример                              |
| ------------------------------------ | ----------------------------------- | ------------------------------------ |
| `codex`                              | Интерактивный REPL                    | `codex`                              |
| `codex "…"`                          | Начальная подсказка для интерактивного REPL | `codex "исправь ошибки линтера"`            |
| `codex -q "…"`                       | Ноинтерактивный "тихий режим"        | `codex -q --json "объясни utils.ts"` |
| `codex completion <bash\|zsh\|fish>` | Вывод скрипта автодополнения для шелла       | `codex completion bash`              |

Ключевые флаги: `--model/-m`, `--approval-mode/-a`, и `--quiet/-q`.

---

## Память и документация проекта

Codex объединяет инструкции Markdown в следующем порядке:

1. `~/.codex/instructions.md` — личные глобальные рекомендации
2. `codex.md` в корне репозитория — общие заметки проекта
3. `codex.md` в текущем рабочем каталоге — специфика подмодулей

Отключить с помощью `--no-project-doc` или `CODEX_DISABLE_PROJECT_DOC=1`.

---

## Ноинтерактивный / CI режим

Запускайте Codex без интерфейса в пайплайнах. Пример шага GitHub Action:

```yaml
- name: Обновление changelog через Codex
  run: |
    npm install -g @openai/codex
    export OPENAI_API_KEY="${{ secrets.OPENAI_KEY }}"
    codex -a auto-edit --quiet "обнови CHANGELOG для следующего релиза"
```

Установите `CODEX_QUIET_MODE=1`, чтобы подавить шум интерактивного UI.

---

## Рецепты

Ниже приведены несколько коротких примеров, которые можно скопировать и вставить. Замените текст в кавычках на свою задачу. См. [руководство по подсказкам](https://github.com/openai/codex/blob/main/codex-cli/examples/prompting_guide.md) для получения дополнительных советов и шаблонов использования.

| ✨  | Что вы вводите                                                                   | Что происходит                                                               |
| --- | ------------------------------------------------------------------------------- | -------------------------------------------------------------------------- |
| 1   | `codex "Переработай компонент Dashboard на React Hooks"`                       | Codex переписывает классовый компонент, запускает `npm test` и показывает diff.   |
| 2   | `codex "Сгенерируй SQL-миграции для добавления таблицы users"`                      | Определяет ваш ORM, создаёт файлы миграций и запускает их в песочнице БД. |
| 3   | `codex "Напиши юнит-тесты для utils/date.ts"`                                    | Генерирует тесты, выполняет их и итерирует, пока они не пройдут.              |
| 4   | `codex "Массово переименуй *.jpeg → *.jpg с помощью git mv"`                                | Безопасно переименовывает файлы и обновляет импорты/использование.                           |
| 5   | `codex "Объясни, что делает этот regex: ^(?=.*[A-Z]).{8,}$"`                      | Выдаёт пошаговое объяснение для человека.                                  |
| 6   | `codex "Тщательно просмотри этот репо и предложи 3 высокоэффективных, чётко определённых PR"` | Предлагает влиятельные PR в текущей кодовой базе.                            |
| 7   | `codex "Ищи уязвимости и создай отчёт по безопасности"`          | Находит и объясняет ошибки безопасности.                                          |

---

## Установка

<details open>
<summary><strong>Из npm (рекомендуется)</strong></summary>

```bash
npm install -g @openai/codex
# или
yarn global add @openai/codex
```

</details>

<details>
<summary><strong>Сборка из исходников</strong></summary>

```bash
# Клонируйте репозиторий и перейдите в пакет CLI
git clone https://github.com/openai/codex.git
cd codex/codex-cli

# Установите зависимости и соберите
npm install
npm run build

# Получите справку по использованию и опциям
node ./dist/cli.js --help

# Запустите локально собранный CLI напрямую
node ./dist/cli.js

# Или свяжите команду глобально для удобства
npm link
```

</details>

---

## Конфигурация

Codex ищет конфигурационные файлы в **`~/.codex/`**.

```yaml
# ~/.codex/config.yaml
model: o4-mini # Модель по умолчанию
fullAutoErrorMode: ask-user # или ignore-and-continue
```

Вы также можете определить пользовательские инструкции:

```yaml
# ~/.codex/instructions.md
- Всегда отвечай с эмодзи
- Используй команды git только если я явно укажу
```

---

## Часто задаваемые вопросы

<details>
<summary>OpenAI выпустила модель под названием Codex в 2021 году — это связано?</summary>

В 2021 году OpenAI выпустила Codex, систему ИИ для генерации кода из текстовых подсказок. Эта исходная модель Codex была устаревшей с марта 2023 года и не связана с инструментом CLI.

</details>

<details>
<summary>Как мне остановить Codex от вмешательства в мой репозиторий?</summary>

Codex всегда сначала запускается в **песочнице**. Если предложенная команда или изменение файла кажется подозрительным, просто ответьте **n** на запрос, и ничего не произойдёт с вашим рабочим деревом.

</details>

<details>
<summary>Работает ли это на Windows?</summary>

Не напрямую. Требуется [Windows Subsystem for Linux (WSL2)](https://learn.microsoft.com/en-us/windows/wsl/install) — Codex тестировался на macOS и Linux с Node ≥ 22.

</details>

<details>
<summary>Какие модели поддерживаются?</summary>

Любая модель, доступная через [Responses API](https://platform.openai.com/docs/api-reference/responses). По умолчанию используется `o4-mini`, но можно передать `--model gpt-4o` или установить `model: gpt-4o` в конфигурационном файле для переопределения.

</details>

---

## Возможности финансирования

Мы рады запустить **инициативу на $1 миллион** для поддержки проектов с открытым исходным кодом, использующих Codex CLI и другие модели OpenAI.

- Гранты выдаются в виде кредитов API на **$25,000**.
- Заявки рассматриваются **на постоянной основе**.

**Заинтересованы? [Подайте заявку здесь](https://openai.com/form/codex-open-source-fund/).**

---

## Вклад в проект

Этот проект находится в активной разработке, и код, вероятно, будет значительно меняться. Мы обновим это сообщение, когда процесс завершится!

В целом мы приветствуем любые вклады — будь то ваш первый запрос на включение или вы опытный мейнтейнер. В то же время мы заботимся о надёжности и долгосрочной поддерживаемости, поэтому планка для слияния кода намеренно **высока**. Приведённые ниже рекомендации объясняют, что означает "высокое качество" на практике, и должны сделать процесс прозрачным и дружелюбным.

### Рабочий процесс разработки

- Создайте _тематическую ветку_ из `main` — например, `feat/interactive-prompt`.
- Сосредоточьтесь на изменениях. Несколько несвязанных исправлений должны быть открыты как отдельные PR.
- Используйте `npm run test:watch` во время разработки для быстрой обратной связи.
- Мы используем **Vitest** для юнит-тестов, **ESLint** + **Prettier** для стиля и **TypeScript** для проверки типов.
- Перед отправкой запустите полный набор тестов/проверок типов/линтера:

  ```bash
  npm test && npm run lint && npm run typecheck
  ```

- Если вы **ещё не** подписали Соглашение о лицензии для участников (CLA), добавьте комментарий к PR с точным текстом:

  ```text
  I have read the CLA Document and I hereby sign the CLA
  ```

  Бот CLA-Assistant пометит статус PR зелёным, как только все авторы подпишут.

```bash
# Режим наблюдения (тесты перезапускаются при изменении)
npm run test:watch

# Проверка типов без генерации файлов
npm run typecheck

# Автоматическое исправление проблем линтера и prettier
npm run lint:fix
npm run format:fix
```

### Написание высокоударных изменений кода

1. **Начните с тикета.** Откройте новый или прокомментируйте существующий, чтобы мы могли договориться о решении до написания кода.
2. **Добавляйте или обновляйте тесты.** Каждая новая функция или исправление бага должно сопровождаться тестами, которые не проходят до изменения и проходят после. 100% покрытие не требуется, но стремитесь к значимым утверждениям.
3. **Документируйте поведение.** Если ваше изменение влияет на поведение, видимое пользователю, обновите README, встроенную справку (`codex --help`) или соответствующие примеры проектов.
4. **Делайте коммиты атомарными.** Каждый коммит должен компилироваться, а тесты должны проходить. Это упрощает проверки и возможные откаты.

### Открытие запроса на включение

- Заполните шаблон PR (или включите аналогичную информацию) — **Что? Почему? Как?**
- Запустите **все** проверки локально (`npm test && npm run lint && npm run typecheck`). Сбои CI, которые можно было поймать локально, замедляют процесс.
- Убедитесь, что ваша ветка актуальна с `main` и конфликты слияния устранены.
- Пометьте PR как **Готов к проверке** только тогда, когда вы считаете, что он находится в состоянии, пригодном для слияния.

### Процесс проверки

1. Один мейнтейнер будет назначен основным ревьюером.
2. Мы можем попросить внести изменения — пожалуйста, не принимайте это на свой счёт. Мы ценим работу, но также ценим согласованность и долгосрочную поддерживаемость.
3. Когда будет достигнут консенсус, что PR соответствует требованиям, мейнтейнер выполнит слияние сжатием.

### Ценности сообщества

- **Будьте добры и инклюзивны.** Относитесь к другим с уважением; мы следуем [Contributor Covenant](https://www.contributor-covenant.org/).
- **Предполагайте добрые намерения.** Письменное общение сложно — склоняйтесь к великодушию.
- **Учите и учитесь.** Если вы заметили что-то непонятное, откройте тикет или PR с улучшениями.

### Получение помощи

Если у вас возникли проблемы с настройкой проекта, вы хотите получить обратную связь по идее или просто сказать _привет_ — пожалуйста, откройте обсуждение или присоединитесь к соответствующему тикету. Мы рады помочь.

Вместе мы можем сделать Codex CLI потрясающим инструментом. **Счастливого хакинга!** :rocket:

### Соглашение о лицензии для участников (CLA)

Все участники **должны** принять CLA. Процесс лёгкий:

1. Откройте ваш запрос на включение.
2. Вставьте следующий комментарий (или ответьте `recheck`, если вы подписали ранее):

   ```text
   I have read the CLA Document and I hereby sign the CLA
   ```

3. Бот CLA-Assistant зафиксирует вашу подпись в репозитории и пометит проверку статуса как пройденную.

Никаких специальных команд Git, вложений в электронные письма или футеров коммитов не требуется.

#### Быстрые исправления

| Сценарий          | Команда                                                                                   |
| ----------------- | ----------------------------------------------------------------------------------------- |
| Исправить последний коммит | `git commit --amend -s --no-edit && git push -f`                                          |
| Только GitHub UI    | Отредактируйте сообщение коммита в PR → добавьте<br>`Signed-off-by: Your Name <email@example.com>` |

Проверка **DCO** блокирует слияние, пока каждый коммит в PR не содержит футер (при сжатии это только один).

### Выпуск `codex`

Чтобы опубликовать новую версию CLI, запустите скрипты выпуска, определённые в `codex-cli/package.json`:

1. Откройте каталог `codex-cli`
2. Убедитесь, что вы на ветке, например `git checkout -b bump-version`
3. Обновите версию и `CLI_VERSION` до текущей даты и времени: `npm run release:version`
4. Зафиксируйте обновление версии (с подписью DCO):
   ```bash
   git add codex-cli/src/utils/session.ts codex-cli/package.json
   git commit -s -m "chore(release): codex-cli v$(node -p \"require('./codex-cli/package.json').version\")"
   ```
5. Скопируйте README, соберите и опубликуйте в npm: `npm run release`
6. Отправьте в ветку: `git push origin HEAD`

---

## Безопасность и ответственный ИИ

Обнаружили уязвимость или обеспокоены результатами модели? Пожалуйста, напишите на **security@openai.com**, и мы оперативно ответим.

---

## Лицензия

Этот репозиторий лицензирован под [лицензией Apache-2.0](LICENSE).