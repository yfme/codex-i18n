<h1 align="center">OpenAI Codex CLI</h1>
<p align="center">ターミナルで動作する軽量なコーディングエージェント</p>

<p align="center"><code>npm i -g @openai/codex</code></p>

[English](./README.md) | [简体中文](./README.zh-CN.md) | [Español](./README.es.md) | [Português](./README.pt.md) | [Русский](./README.ru.md) | [Français](./README.fr.md) | [Deutsch](./README.de.md) | **日本語** | [한국어](./README.ko.md) | [繁體中文](./README.zh-TW.md) | [Bahasa Indonesia](./README.id.md) | [Italiano](./README.it.md)

![Codex demo GIF using: codex "explain this codebase to me"](./.github/demo.gif)

---

<details>
<summary><strong>目次</strong></summary>

- [実験的技術に関する免責事項](#実験的技術に関する免責事項)
- [クイックスタート](#クイックスタート)
- [なぜCodex？](#なぜcodex)
- [セキュリティモデルと権限](#セキュリティモデルと権限)
  - [プラットフォームのサンドボックス詳細](#プラットフォームのサンドボックス詳細)
- [システム要件](#システム要件)
- [CLIリファレンス](#cliリファレンス)
- [メモリとプロジェクトドキュメント](#メモリとプロジェクトドキュメント)
- [非対話型 / CIモード](#非対話型--ciモード)
- [レシピ](#レシピ)
- [インストール](#インストール)
- [設定](#設定)
- [FAQ](#faq)
- [資金提供の機会](#資金提供の機会)
- [貢献](#貢献)
  - [開発ワークフロー](#開発ワークフロー)
  - [高インパクトなコード変更の作成](#高インパクトなコード変更の作成)
  - [プルリクエストの作成](#プルリクエストの作成)
  - [レビュープロセス](#レビュープロセス)
  - [コミュニティの価値観](#コミュニティの価値観)
  - [ヘルプの取得](#ヘルプの取得)
  - [コントリビューター使用許諾契約（CLA）](#コントリビューター使用許諾契約-cla)
    - [クイックフィックス](#クイックフィックス)
  - [`codex`のリリース](#codexのリリース)
- [セキュリティと責任あるAI](#セキュリティと責任あるai)
- [ライセンス](#ライセンス)

</details>

---

## 実験的技術に関する免責事項

Codex CLIは、活発に開発中の実験的プロジェクトです。まだ安定しておらず、バグ、不完全な機能、または破壊的変更が発生する可能性があります。私たちはコミュニティとオープンに開発を進めており、以下を歓迎します：

- バグ報告
- 機能リクエスト
- プルリクエスト
- ポジティブなフィードバック

イシューの提出やPRの送信を通じて改善にご協力ください（貢献方法については以下のセクションを参照）！

## クイックスタート

グローバルにインストール：

```shell
npm install -g @openai/codex
```

次に、OpenAI APIキーを環境変数として設定：

```shell
export OPENAI_API_KEY="your-api-key-here"
```

> **注：** このコマンドは現在のターミナルセッションでのみキーを設定します。永続化するには、シェルの設定ファイル（例：`~/.zshrc`）に`export`行を追加してください。

対話的に実行：

```shell
codex
```

または、プロンプトを入力として実行（オプションで`Full Auto`モード）：

```shell
codex "このコードベースを説明して"
```

```shell
codex --approval-mode full-auto "最も豪華なToDoリストアプリを作成"
```

これで完了です – Codexはファイルを生成し、サンドボックス内で実行し、不足している依存関係をインストールし、ライブ結果を表示します。変更を承認すると、作業ディレクトリにコミットされます。

---

## なぜCodex？

Codex CLIは、すでに**ターミナルで作業している**開発者向けに構築されており、ChatGPTレベルの推論能力に加えて、**実際にコードを実行し、ファイルを操作し、反復する**力を提供します – すべてバージョン管理の下で。簡単に言えば、リポジトリを理解し実行する_チャット駆動型開発_ツールです。

- **ゼロセットアップ** — OpenAI APIキーを持参すればすぐに動作！
- **完全自動承認、安全かつセキュア** — ネットワーク無効化とディレクトリサンドボックスで実現
- **マルチモーダル** — スクリーンショットや図を渡して機能を実装 ✨

そして、**完全にオープンソース**なので、開発の様子を確認し、貢献することができます！

---

## セキュリティモデルと権限

Codexは、`--approval-mode`フラグ（または対話型のオンボーディングプロンプト）を通じて、エージェントが受ける_自律性の程度_と自動承認ポリシーを決定できます：

| モード                      | エージェントが許可なく実行可能なこと            | 承認が必要なこと                                         |
| ------------------------- | ----------------------------------------------- | --------------------------------------------------------------- |
| **提案** <br>(デフォルト) | • リポジトリ内のすべてのファイルの読み取り                     | • **すべての**ファイル書き込み/パッチ <br>• **すべての**シェル/Bashコマンド |
| **自動編集**             | • ファイルの読み取り**および**パッチ書き込みの適用      | • **すべての**シェル/Bashコマンド                                   |
| **完全自動**             | • ファイルの読み書き <br>• シェルコマンドの実行 | —                                                               |

**完全自動**モードでは、すべてのコマンドが**ネットワーク無効化**で実行され、現在の作業ディレクトリ（および一時ファイル）に限定され、防御を強化します。ディレクトリがGitで_追跡されていない_場合、**自動編集**または**完全自動**モードで開始すると、Codexは警告/確認を表示するので、常にセーフティネットがあります。

近日公開：追加の安全対策に自信が持て次第、特定のコマンドをネットワーク有効で自動実行できるホワイトリストを設定可能になります。

### プラットフォームのサンドボックス詳細

Codexが使用する強化メカニズムはOSに依存します：

- **macOS 12+** – コマンドは**Apple Seatbelt**（`sandbox-exec`）でラップされます。

  - 書き込み可能なルートディレクトリ（`$PWD`、`$TMPDIR`、`~/.codex`など）を除き、すべてが読み取り専用の監獄に配置されます。
  - デフォルトではアウトバウンドネットワークが_完全にブロック_されます – 子プロセスがどこかに`curl`しようとしても失敗します。

- **Linux** – サンドボックスにはDockerの使用を推奨します。Codexは**最小コンテナイメージ**内で自身を起動し、リポジトリを同じパスに_読み書き_でマウントします。カスタムの`iptables`/`ipset`ファイアウォールスクリプトは、OpenAI APIを除くすべてのアウトバウンドを拒否します。これにより、ホストでルート権限を必要とせずに、決定的で再現可能な実行が可能です。詳細は[`run_in_container.sh`](./codex-cli/scripts/run_in_container.sh)を参照してください。

どちらのアプローチも日常の使用において_透過的_です – リポジトリのルートから`codex`を実行し、通常通りステップを承認/拒否できます。

---

## システム要件

| 要件                 | 詳細                                                         |
| --------------------------- | --------------------------------------------------------------- |
| オペレーティングシステム           | macOS 12+、Ubuntu 20.04+/Debian 10+、またはWindows 11 **WSL2経由** |
| Node.js                     | **22以降**（LTS推奨）                               |
| Git（オプション、推奨） | 2.23+ ビルトインPRヘルパー用                                   |
| RAM                         | 最小4GB（8GB推奨）                                 |

> 決して`sudo npm install -g`を実行しないでください。代わりにnpmの権限を修正してください。

---

## CLIリファレンス

| コマンド                              | 目的                             | 例                              |
| ------------------------------------ | ----------------------------------- | ------------------------------------ |
| `codex`                              | 対話型REPL                    | `codex`                              |
| `codex "…"`                          | 対話型REPLの初期プロンプト | `codex "リントエラーを修正"`            |
| `codex -q "…"`                       | 非対話型「クワイエットモード」        | `codex -q --json "utils.tsを説明"` |
| `codex completion <bash\|zsh\|fish>` | シェル補完スクリプトの出力       | `codex completion bash`              |

主要なフラグ：`--model/-m`、`--approval-mode/-a`、および`--quiet/-q`。

---

## メモリとプロジェクトドキュメント

Codexは以下の順序でMarkdown指示をマージします：

1. `~/.codex/instructions.md` – 個人用のグローバルガイダンス
2. リポジトリルートの`codex.md` – 共有プロジェクトノート
3. 現在の作業ディレクトリの`codex.md` – サブパッケージの詳細

`--no-project-doc`または`CODEX_DISABLE_PROJECT_DOC=1`で無効化してください。

---

## 非対話型 / CIモード

パイプラインでヘッドレスでCodexを実行します。GitHub Actionのステップ例：

```yaml
- name: Codexを介して変更ログを更新
  run: |
    npm install -g @openai/codex
    export OPENAI_API_KEY="${{ secrets.OPENAI_KEY }}"
    codex -a auto-edit --quiet "次回リリース用のCHANGELOGを更新"
```

`CODEX_QUIET_MODE=1`を設定して、対話型UIのノイズを抑制します。

---

## レシピ

以下はコピー＆ペースト可能な簡単な例です。引用符内のテキストを自分のタスクに置き換えてください。さらに詳しいヒントや使用パターンは、[プロンプトガイド](https://github.com/openai/codex/blob/main/codex-cli/examples/prompting_guide.md)を参照してください。

| ✨  | 入力内容                                                                   | 何が起こるか                                                               |
| --- | ------------------------------------------------------------------------------- | -------------------------------------------------------------------------- |
| 1   | `codex "ダッシュボードコンポーネントをReact Hooksにリファクタリング"`                       | Codexはクラスコンポーネントを書き換え、`npm test`を実行し、差分を表示します。   |
| 2   | `codex "ユーザーテーブル追加のためのSQLマイグレーションを生成"`                      | ORMを推測し、マイグレーションファイルを作成し、サンドボックスDBで実行します。 |
| 3   | `codex "utils/date.tsのユニットテストを記述"`                                    | テストを生成し、実行し、合格するまで反復します。              |
| 4   | `codex "git mvで*.jpeg → *.jpgを一括リネーム"`                                | ファイルを安全にリネームし、インポート/使用を更新します。                           |
| 5   | `codex "この正規表現の説明：^(?=.*[A-Z]).{8,}$"`                      | ステップごとの人間向けの説明を出力します。                                  |
| 6   | `codex "このリポジトリを慎重にレビューし、影響力のある3つの明確なPRを提案"` | 現在のコードベースで影響力のあるPRを提案します。                            |
| 7   | `codex "脆弱性を探し、セキュリティレビュー報告書を作成"`          | セキュリティバグを見つけ、説明します。                                          |

---

## インストール

<details open>
<summary><strong>npmから（推奨）</strong></summary>

```bash
npm install -g @openai/codex
# または
yarn global add @openai/codex
```

</details>

<details>
<summary><strong>ソースからビルド</strong></summary>

```bash
# リポジトリをクローンし、CLIパッケージに移動
git clone https://github.com/openai/codex.git
cd codex/codex-cli

# 依存関係をインストールし、ビルド
npm install
npm run build

# 使用方法とオプションを取得
node ./dist/cli.js --help

# ローカルでビルドされたCLIを直接実行
node ./dist/cli.js

# または、便利のためにコマンドをグローバルにリンク
npm link
```

</details>

---

## 設定

Codexは**`~/.codex/`**で設定ファイルを探します。

```yaml
# ~/.codex/config.yaml
model: o4-mini # デフォルトモデル
fullAutoErrorMode: ask-user # または ignore-and-continue
```

カスタム指示も定義できます：

```yaml
# ~/.codex/instructions.md
- 常に絵文字で応答
- 私が明示的に指定した場合にのみgitコマンドを使用
```

---

## FAQ

<details>
<summary>OpenAIは2021年にCodexというモデルをリリースしましたが、これは関連していますか？</summary>

2021年、OpenAIは自然言語プロンプトからコードを生成するAIシステムCodexをリリースしました。この元のCodexモデルは2023年3月に廃止され、CLIツールとは別です。

</details>

<details>
<summary>Codexが私のリポジトリに触れないようにするにはどうすればいいですか？</summary>

Codexは常に**最初にサンドボックスで実行**します。提案されたコマンドやファイル変更が疑わしい場合、プロンプトで**n**と答えるだけで、作業ツリーに何も起こりません。

</details>

<details>
<summary>Windowsで動作しますか？</summary>

直接的には動作しません。[Windows Subsystem for Linux (WSL2)](https://learn.microsoft.com/en-us/windows/wsl/install)が必要です – CodexはmacOSおよびLinuxでNode ≥ 22でテストされています。

</details>

<details>
<summary>どのモデルがサポートされていますか？</summary>

[Responses API](https://platform.openai.com/docs/api-reference/responses)で利用可能なすべてのモデル。デフォルトは`o4-mini`ですが、`--model gpt-4o`を渡すか、設定ファイルで`model: gpt-4o`を設定して上書きできます。

</details>

---

## 資金提供の機会

私たちは、Codex CLIおよびその他のOpenAIモデルを使用するオープンソースプロジェクトを支援する**100万ドルのイニシアチブ**を開始することに興奮しています。

- 助成金は**25,000ドル**のAPIクレジット単位で授与されます。
- 申請は**随時レビュー**されます。

**興味がありますか？[こちらで申請](https://openai.com/form/codex-open-source-fund/)してください。**

---

## 貢献

このプロジェクトは活発に開発中であり、コードは大幅に変更される可能性があります。完了したらこのメッセージを更新します！

より広く、私たちは初めてのプルリクエストを作成する方から経験豊富なメンテナーまで、あらゆる貢献を歓迎します。同時に、信頼性と長期的なメンテナンス性を重視しているため、コードのマージ基準は意図的に**高く**設定されています。以下のガイドラインは、「高品質」が実際何を意味するかを説明し、プロセス全体を透明でフレンドリーなものにするはずです。

### 開発ワークフロー

- `main`から_トピックブランチ_を作成 – 例：`feat/interactive-prompt`。
- 変更を集中させます。関連のない複数の修正は別々のPRで開く必要があります。
- 開発中は`npm run test:watch`を使用して高速なフィードバックを得ます。
- 私たちはユニットテストに**Vitest**、スタイルに**ESLint** + **Prettier**、型チェックに**TypeScript**を使用します。
- プッシュ前に、完全なテスト/型/リントスイートを実行：

  ```bash
  npm test && npm run lint && npm run typecheck
  ```

- まだコントリビューター使用許諾契約（CLA）を**署名していない場合**、PRに以下の正確なテキストを含むコメントを追加：

  ```text
  I have read the CLA Document and I hereby sign the CLA
  ```

  CLA-Assistantボットは、すべての著者が署名するとPRのステータスを緑にします。

```bash
# ウォッチモード（変更時にテストを再実行）
npm run test:watch

# ファイルを出力せずに型チェック
npm run typecheck

# リントおよびprettierの問題を自動修正
npm run lint:fix
npm run format:fix
```

### 高インパクトなコード変更の作成

1. **イシューから始める。** 新しいイシューを開くか、既存のディスカッションにコメントして、コードを書く前に解決策に合意します。
2. **テストの追加または更新。** 新しい機能やバグ修正には、変更前には失敗し、変更後には通過するテストカバレッジが必要です。100％のカバレッジは必須ではありませんが、意味のあるアサーションを目指してください。
3. **動作のドキュメント化。** 変更がユーザー向けの動作に影響する場合、README、インラインヘルプ（`codex --help`）、または関連するサンプルプロジェクトを更新します。
4. **コミットをアトミックに保つ。** 各コミットはコンパイル可能で、テストが通過する必要があります。これにより、レビューや潜在的なロールバックが容易になります。

### プルリクエストの作成

- PRテンプレートを記入（または同様の情報を含める） – **何？なぜ？どうやって？**
- ローカルで**すべての**チェックを実行（`npm test && npm run lint && npm run typecheck`）。ローカルで捕捉できたCIの失敗はプロセスを遅らせます。
- ブランチが`main`と最新であり、マージの競合が解決されていることを確認します。
- PRがマージ可能な状態だと信じる場合にのみ**レビュー準備完了**とマークします。

### レビュープロセス

1. 1人のメンテナーが主要なレビュアーとして割り当てられます。
2. 変更を依頼する場合があります – これは個人的なものと受け取らないでください。私たちはあなたの作業を大切にしていますが、一貫性と長期的なメンテナンス性も重視しています。
3. PRが基準を満たしているというコンセンサスが得られたら、メンテナーがスクワッシュマージを行います。

### コミュニティの価値観

- **親切で包括的である。** 他人を尊重して扱います。私たちは[Contributor Covenant](https://www.contributor-covenant.org/)に従います。
- **善意を前提とする。** 書面でのコミュニケーションは難しい – 寛大さを優先してください。
- **教え、学ぶ。** 混乱を招くものを見つけたら、イシューまたはPRで改善を提案してください。

### ヘルプの取得

プロジェクトのセットアップで問題が発生したり、アイデアに対するフィードバックが必要だったり、ただ_こんにちは_と言いたい場合 – ディスカッションを開くか、関連するイシューに参加してください。私たちは喜んでお手伝いします。

一緒にCodex CLIを素晴らしいツールにしましょう。**ハッピーハッキング！** :rocket:

### コントリビューター使用許諾契約（CLA）

すべてのコントリビューターは**CLAを受け入れる必要があります**。プロセスは軽量です：

1. プルリクエストを作成します。
2. 以下のコメントを貼り付けます（または、以前に署名した場合は`recheck`と返信）：

   ```text
   I have read the CLA Document and I hereby sign the CLA
   ```

3. CLA-Assistantボットがリポジトリに署名を記録し、ステータスチェックを合格とマークします。

特別なGitコマンド、メール添付、またはコミットフッターは必要ありません。

#### クイックフィックス

| シナリオ          | コマンド                                                                                   |
| ----------------- | ----------------------------------------------------------------------------------------- |
| 最後のコミットを修正 | `git commit --amend -s --no-edit && git push -f`                                          |
| GitHub UIのみ    | PRでコミットメッセージを編集 → 追加<br>`Signed-off-by: Your Name <email@example.com>` |

**DCOチェック**は、PRのすべてのコミットがフッターを持つまでマージをブロックします（スクワッシュの場合は1つだけ）。

### `codex`のリリース

CLIの新バージョンを公開するには、`codex-cli/package.json`で定義されたリリーススクリプトを実行します：

1. `codex-cli`ディレクトリを開きます
2. `git checkout -b bump-version`のようなブランチにいることを確認します
3. バージョンと`CLI_VERSION`を現在の日時に更新：`npm run release:version`
4. バージョンの更新をコミット（DCO署名付き）：
   ```bash
   git add codex-cli/src/utils/session.ts codex-cli/package.json
   git commit -s -m "chore(release): codex-cli v$(node -p \"require('./codex-cli/package.json').version\")"
   ```
5. READMEをコピーし、ビルドし、npmに公開：`npm run release`
6. ブランチにプッシュ：`git push origin HEAD`

---

## セキュリティと責任あるAI

脆弱性を発見したり、モデル出力に懸念がある場合？ **security@openai.com**にメールしてください。迅速に対応します。

---

## ライセンス

このリポジトリは[Apache-2.0ライセンス](LICENSE)の下でライセンスされています。